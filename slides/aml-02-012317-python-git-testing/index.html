<!DOCTYPE html>
<html>
  <head>
    <title>Title</title>
    <meta charset="utf-8">
    <style>
      @import url(https://fonts.googleapis.com/css?family=Garamond);
      @import url(https://fonts.googleapis.com/css?family=Muli:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

      body {
        font-family: 'Muli';
        font-size: 140%;
      }
      h1, h2 {
        font-family: 'Garamond';
        font-weight: normal;
      }
      .remark-slide-content h1 {
        font-size: 70px;
        text-align: center;
      }

      .remark-slide-content p, .remark-slide-content li {
        font-size:40px;
        line-height: 1.6;
      }
      .remark-slide-content .compact {
          font-size: 30px;
          line-height: 1.1;
          display: block;
      }

      .larger {
          font-size: 40px;
      }
      .largest {
          font-size: 50px;
      }
      .left-column, .right-column {
          width: 48%;
          float: left;
      }
      .right-column {
          float: right;
      }
      .left-column {
          float: left;
      }

      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
    </style>
  </head>
  <body>
    <textarea id="source">

class: center, middle

### W4995 Applied Machine Learning

# Tools and Infrastructure

01/22/18

Andreas C. Müller

???

---

class: middle

# So you think you know git?

---

![:scale 40%](images/git_xkcd.png)

---

![:scale 40%](images/torvalds_ducreux.jpg)

---

# Git Basics

- Repository

``$ git init``

``$ rm .git``

- Commit

- Remote

---

# Typical Workflow

- Clone

- Branch

- Add, commit, add, commit, add, commit, ...

- Merge / rebase

- Push

---

# Some tips

- ``$ git status``

- Install shell plugins for status and branch (``oh-my-zsh``)

![:scale 40%](images/git_shell_extension.png)

- Set editor, pager and diff-tool

- Use ``.gitignore``

---

# Git log

![:scale 40%](images/git_log.png)

---

![:scale 40%](images/git_adog.png)

---

# Understanding Git

- Working directory

- Index

- Staging Area

- Branches

- Head

---

# Commands - And what they do

- ``git add``
puts files from working director into staging area. If not in index, adds them to tracked files.

- ``git commit``
commits files from staging area (index) to repository, moves current branch with HEAD

- ``git checkout [<commit>] [<file>]``
Set ``<file>`` in working directory to state at ``<commit>`` and stages it.

- ``git checkout [-b] <branch>``
moves HEAD to ``<branch>`` (-b creates it), changes content of working dir

- ``git reset --soft <commit>``
moves HEAD to ``<commit>`` (takes the current branch with it)

- ``git reset --mixed <commit>``
moves HEAD to ``<commit>``,  changes index to be at ``<commit>`` (but not working directory)

- ``git reset --hard <commit>``
moved HEAD to ``<commit>``, changes index and working tree to ``<commit>``.

---

# Merge

- Fast-forward merge:

![scale:80%](images/git_fast_forward_merge.png)

- Merge-commits:

![scale:80%](images/git_merge_commit.png)

---

# Rebase

- Rebase

![scale:80%](images/git_rebase1.png)

- Rebase onto
.left-column[
![scale:80%](images/git_rebase2.png)
]
.right-column[
![scale:80%](images/git_rebase3.png)
]
``git rebase --onto master next``

---

# Squash before Rebase

---

# Interactive rebase

``git rebase -i <commit>``

![scale:80%](images/git_interactive_rebase.png)

---
# Interactive adding

![scale:80%](images/git_interactive_add.png)

---

# git gui

![scale:80%](images/git_interactive_add.png)

---

# gitk

![scale:80%](images/git_interactive_add.png)

---

# reflog

![scale:80%](images/git_reflog.png)

---

# Git for ages 4 and up:

https://www.youtube.com/watch?v=1ffBJ4sVUb4

(with play-doh!)

---

# Github - just another remote

---

# Github pull request workflow

---

# Github pull request workflow

---

# End version control – but github will come back later ;)

---

# General coding guidelines

---

Programs must be written for people to read, and only incidentally for machines to execute.
- Harold Abelson (wizard book)

---

Everyone knows that debugging is twice as hard as writing a program in the first place. So if you're as clever as you can be when you write it, how will you ever debug it? 
- Brian Kernighan

---

 Don’t be clever!
Make it readable!

Future you is the most likely person to try to understand your code.

Avoid writing code.

---

# Python basics

---

# Why Python?

- General purpose language
- Great libraries
- Easy to learn / use
- Contenders: R (Scala? Julia?)

---

# The two language problem

Python is sloooow…A


- Numpy: C
- Scipy: C, fortran
- Pandas: Cython, Python
- Scikit-learn: Cython, Python

- CPython: C

---

# Python 2 vs Python 3

- “current” : 2.7, 3.4, 3.5, 3.6, 3.7

Changes (that will bite you)

- ``print``

- division

- Iterators (range, zip, map, filter, dictionary keys, values, items)

- Strings / unicode

---

# Python 2 && Python 3

- from __future__ import print_function
- Six – tools for making 2 and 3 compatible code
- 2to3 – convert python2 code to python3 code

---

# Python ...

Package management:

- Virtual environments

- pip (and wheels)

- Conda (and anaconda and conda-forge)

---

# Pip and upgrades

Pip upgrade works on dependencies (unless you do –no-dep)

---

# Conda

Conda looks like the best bet.
Use conda environments!

---

# Dynamically typed, interpreted

- Invalid syntax lying around

- Code is less self-documenting

---

# Editors

- Flake8 / pyflake

- Scripted / weak typing: Have a syntax checker!

- use autopep8 if you have code lying around

---

# Unit Tests and integration tests

---

# Why test?

- Ensure that code works correctly.
- Ensure that changes don’t break anything.
- Ensure that bugs are not reintroduced.
- Ensure robustness to user errors.
- Ensure code is reachable.

---

# Test-driven development?

---

# Types of tests

- Unit tests – function does the right thing.

- Integration tests – system / process does the right thing.

- Non-regression tests – bug got removed (and will not be reintroduced).

---

# How to test? 

- py.test – http://doc.pytest.org

- Searches for all test_*.py files, runs all test_* methods.

- Reports nice errors!

- Dig deeper: http://pybites.blogspot.com/2011/07/behind-scenes-of-pytests-new-assertion.html

---

# Example

``python
# content of test_sample.py

def inc(x):
    return x + 2


def test_answer():
    assert inc(3) == 4
``

![:scale 50%](images/pytest_failure.png)

---

# Example

``python
# content of test_sample.py

def inc(x):
    return x + 1


def test_answer():
    assert inc(3) == 4
``

![:scale 50%](images/pytest_passed.png)

# Test coverage

.left-column[
``python
# inc.py
def inc(x):
    if x < 0:
        return 0
    return x + 1


def dec(x):
     return x - 1
``

.right-column[
``python
# test_inc.py
from inc import inc

def test_inc():
     assert inc(3) == 4
``
]

---

#

---

#

---

#

---

#

---

#

---

#

---

#

---
class: middle

# Questions ?

    </textarea>
    <script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <script>
    // Config Remark
    remark.macros['scale'] = function (percentage) {
        var url = this;
        return '<img src="' + url + '" style="width: ' + percentage + '" />';
    };
    config_remark = {
        highlightStyle: 'github',
        highlightSpans: true,
        highlightLines: true,
        ratio: "16:9"
    };
      var slideshow = remark.create(config_remark);

    // Configure MathJax
    MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] /* removed 'code' entry*/
    }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i = 0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
    </script>
  </body>
</html>
